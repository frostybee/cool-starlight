/* Simplified SlideViewer Theme System with --fb prefix */

@layer fbSlideViewer {
  /* Core theme system - each theme only needs to define these base colors */
  :root {
    /* Base color system - themes override these */
    --fb-primary: #3b82f6;      /* Main accent color */
    --fb-secondary: #64748b;    /* Secondary accent */
    --fb-background: #ffffff;   /* Main background */
    --fb-surface: #f8fafc;      /* Cards, panels */
    --fb-text: #1f2937;         /* Primary text */
    --fb-text-muted: #64748b;   /* Secondary text */
    --fb-border: #e2e8f0;       /* Borders, dividers */
    --fb-success: #10b981;      /* Success states */
    --fb-warning: #f59e0b;      /* Warning states */
    --fb-error: #ef4444;        /* Error states */
  }

  /* Derived variables - automatically calculated from base colors */
  :root {
    /* Derived colors using color-mix (with fallbacks) */
    --fb-primary-hover: color-mix(in srgb, var(--fb-primary) 85%, black);
    --fb-primary-light: color-mix(in srgb, var(--fb-primary) 10%, transparent);
    --fb-surface-hover: color-mix(in srgb, var(--fb-surface) 95%, var(--fb-primary));
    --fb-border-hover: color-mix(in srgb, var(--fb-border) 70%, var(--fb-primary));
    
    /* Fallbacks for older browsers */
    --fb-primary-hover: var(--fb-primary, #2563eb);
    --fb-primary-light: rgba(59, 130, 246, 0.1);
    --fb-surface-hover: var(--fb-surface, #f1f5f9);
    --fb-border-hover: var(--fb-border, #cbd5e1);

    /* Semantic color mappings */
    --fb-toc-bg: var(--fb-surface);
    --fb-toc-text: var(--fb-text);
    --fb-toc-border: var(--fb-border);
    --fb-toc-hover-bg: var(--fb-surface-hover);
    --fb-toc-hover-border: var(--fb-primary);
    --fb-toc-active-bg: var(--fb-warning);
    --fb-toc-active-text: var(--fb-text);
    
    --fb-progress-bg: var(--fb-border);
    --fb-progress-fill: var(--fb-warning);
    
    --fb-btn-primary-bg: var(--fb-primary);
    --fb-btn-primary-text: white;
    --fb-btn-primary-hover: var(--fb-primary-hover);
    --fb-btn-secondary-bg: var(--fb-surface);
    --fb-btn-secondary-text: var(--fb-text);
    --fb-btn-secondary-hover: var(--fb-surface-hover);
    
    --fb-search-highlight-bg: var(--fb-success);
    --fb-search-highlight-text: white;
    
    --fb-bookmark-bg: var(--fb-primary-light);
    --fb-bookmark-border: var(--fb-primary);
    --fb-bookmark-text: var(--fb-primary);
  }

  /* Base slide viewer styles using semantic variables */
  .fb-slide__container,
  .fb-slide__modal {
    background-color: var(--fb-background);
    color: var(--fb-text);
  }

  .fb-slide__toc {
    background-color: var(--fb-toc-bg);
    border-color: var(--fb-toc-border);
    color: var(--fb-toc-text);
  }

  .fb-slide__toc-item:hover {
    background-color: var(--fb-toc-hover-bg);
    border-color: var(--fb-toc-hover-border);
  }

  .fb-slide__toc-item.active {
    background-color: var(--fb-toc-active-bg);
    color: var(--fb-toc-active-text);
  }

  .fb-slide__progress-bar {
    background-color: var(--fb-progress-bg);
  }

  .fb-slide__progress-fill {
    background-color: var(--fb-progress-fill);
  }

  /* Theme definitions - only base colors needed */
  
  /* Light Theme */
  .fb-slide__theme-light {
    --fb-primary: #3b82f6;
    --fb-secondary: #64748b;
    --fb-background: #ffffff;
    --fb-surface: #f8fafc;
    --fb-text: #1f2937;
    --fb-text-muted: #64748b;
    --fb-border: #e2e8f0;
    --fb-success: #10b981;
    --fb-warning: #f59e0b;
    --fb-error: #ef4444;
  }

  /* Dark Theme */
  .fb-slide__theme-dark {
    --fb-primary: #3b82f6;
    --fb-secondary: #94a3b8;
    --fb-background: #0f172a;
    --fb-surface: #1e293b;
    --fb-text: #f9fafb;
    --fb-text-muted: #94a3b8;
    --fb-border: #374151;
    --fb-success: #10b981;
    --fb-warning: #fbbf24;
    --fb-error: #ef4444;
  }

  /* Dracula Theme */
  .fb-slide__theme-dracula {
    --fb-primary: #ff79c6;
    --fb-secondary: #6272a4;
    --fb-background: #282a36;
    --fb-surface: #44475a;
    --fb-text: #f8f8f2;
    --fb-text-muted: #6272a4;
    --fb-border: #6272a4;
    --fb-success: #50fa7b;
    --fb-warning: #ffb86c;
    --fb-error: #ff5555;
  }

  /* GitHub Theme */
  .fb-slide__theme-github {
    --fb-primary: #58a6ff;
    --fb-secondary: #7d8590;
    --fb-background: #0d1117;
    --fb-surface: #21262d;
    --fb-text: #f0f6fc;
    --fb-text-muted: #7d8590;
    --fb-border: #30363d;
    --fb-success: #3fb950;
    --fb-warning: #f0883e;
    --fb-error: #da3633;
  }

  /* Discord Theme */
  .fb-slide__theme-discord {
    --fb-primary: #5865f2;
    --fb-secondary: #72767d;
    --fb-background: #2f3136;
    --fb-surface: #36393f;
    --fb-text: #ffffff;
    --fb-text-muted: #72767d;
    --fb-border: #40444b;
    --fb-success: #57f287;
    --fb-warning: #fee75c;
    --fb-error: #ed4245;
  }

  /* One Dark Theme */
  .fb-slide__theme-onedark {
    --fb-primary: #61afef;
    --fb-secondary: #5c6370;
    --fb-background: #282c34;
    --fb-surface: #2c323c;
    --fb-text: #abb2bf;
    --fb-text-muted: #5c6370;
    --fb-border: #3e4451;
    --fb-success: #98c379;
    --fb-warning: #e5c07b;
    --fb-error: #e06c75;
  }

  /* Component-specific overrides when needed */
  .fb-slide__theme-dracula {
    --fb-toc-active-text: #282a36; /* Dark text on pink background */
  }

  .fb-slide__theme-github {
    --fb-btn-primary-text: #0d1117; /* Dark text on blue background */
  }

  /* Utility classes for common patterns */
  .fb-theme-surface {
    background-color: var(--fb-surface);
    border: 1px solid var(--fb-border);
  }

  .fb-theme-button-primary {
    background-color: var(--fb-btn-primary-bg);
    color: var(--fb-btn-primary-text);
    border: none;
    transition: background-color 0.2s ease;
  }

  .fb-theme-button-primary:hover {
    background-color: var(--fb-btn-primary-hover);
  }

  .fb-theme-button-secondary {
    background-color: var(--fb-btn-secondary-bg);
    color: var(--fb-btn-secondary-text);
    border: 1px solid var(--fb-border);
  }

  .fb-theme-button-secondary:hover {
    background-color: var(--fb-btn-secondary-hover);
    border-color: var(--fb-border-hover);
  }
}

/* Advanced: Auto-generate hover states using CSS functions (modern browsers) */
@supports (color: color-mix(in srgb, red, blue)) {
  :root {
    --fb-primary-hover: color-mix(in srgb, var(--fb-primary) 85%, black);
    --fb-surface-hover: color-mix(in srgb, var(--fb-surface) 95%, var(--fb-primary));
    --fb-border-hover: color-mix(in srgb, var(--fb-border) 70%, var(--fb-primary));
  }
}

/* Responsive theme adjustments */
@media (max-width: 768px) {
  :root {
    --fb-surface: color-mix(in srgb, var(--fb-surface) 98%, var(--fb-background));
  }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  :root {
    --fb-border: color-mix(in srgb, var(--fb-text) 30%, transparent);
    --fb-toc-hover-border: var(--fb-text);
  }
}